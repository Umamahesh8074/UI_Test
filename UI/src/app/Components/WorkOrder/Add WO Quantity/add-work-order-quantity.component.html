<div class="wo-pac-header">ADD/EDIT/AMENDMENT WORK ORDER QUANTITY</div>

<div class="woq-filters-div">
  <div class="woq-search-container">
    <mat-form-field class="search-class-sc" appearance="outline">
      <mat-label> Search/Select Service Code </mat-label>
      <input
        type="text"
        matInput
        (input)="searchServiceCode($event)"
        [formControl]="serviceCode"
        [matAutocomplete]="serviceCodeAuto"
      />
      <mat-autocomplete
        #serviceCodeAuto="matAutocomplete"
        (optionSelected)="onServiceCodeSelect($event)"
        [displayWith]="displayServiceCode"
      >
        <mat-option *ngFor="let option of serviceCodes" [value]="option">
          {{ option.serviceCode }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <div class="button-container">
    <button mat-flat-button (click)="AddWoQuantity()" class="btn-class primary">
      <mat-icon class="font">add</mat-icon> ADD
    </button>
  </div>
</div>

<mat-card class="cmn-card">
  <mat-card-content class="cmn-card-content">
    <div class="tab-head">
      <ng-container *ngIf="workOrderQuantitiesData">
        <ng-container
          *ngIf="!hasAmendment1 && workOrderQuantitiesData.length > 0"
        >
          <table
            mat-table
            [dataSource]="workOrderQuantitiesData"
            class="mat-elevation-z8"
          >
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef>#</th>
              <td mat-cell *matCellDef="let element; let i = index">
                {{ pageIndex * pageSize + i + 1 }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceCode">
              <th mat-header-cell *matHeaderCellDef>Service Code</th>
              <td mat-cell *matCellDef="let element">
                {{ element.serviceCode }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceDescription">
              <th mat-header-cell *matHeaderCellDef>Service Description</th>
              <td mat-cell *matCellDef="let element">
               <div [innerHTML]="element.serviceDescription"></div>
              </td>
            </ng-container>

            <ng-container matColumnDef="scUomRefValue">
              <th mat-header-cell *matHeaderCellDef>Service Uom</th>
              <td mat-cell *matCellDef="let element">
                {{ element.scUomRefValue }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceGroupCode">
              <th mat-header-cell *matHeaderCellDef>Service Group</th>
              <td mat-cell *matCellDef="let element">
                {{ element.serviceGroupCode }}
              </td>
            </ng-container>

            <ng-container matColumnDef="primeActivityNumber">
              <th mat-header-cell *matHeaderCellDef>Prime Activity Number</th>
              <td mat-cell *matCellDef="let element">
                {{ element.primeActivityNumber }}
              </td>
            </ng-container>

            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef>Quantity</th>
              <td mat-cell *matCellDef="let element">
                {{ element.quantity | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="rate">
              <th mat-header-cell *matHeaderCellDef>Rate</th>
              <td mat-cell *matCellDef="let element">
                {{ element.rate | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="value">
              <th mat-header-cell *matHeaderCellDef>Value</th>
              <td mat-cell *matCellDef="let element">
                {{ element.value | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="gstWithAmount">
              <th mat-header-cell *matHeaderCellDef>GST With Amount</th>
              <td mat-cell *matCellDef="let element">
                {{ element.gstWithAmount | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="budgetQuantity">
              <th mat-header-cell *matHeaderCellDef>Budget Quantity</th>
              <td mat-cell *matCellDef="let element">
                {{ element.budgetQuantity | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="workOrderQuantityStatus">
              <th mat-header-cell *matHeaderCellDef>Quantity Status</th>
              <td mat-cell *matCellDef="let element">
                {{ element.workOrderQuantityStatus }}
              </td>
            </ng-container>
            <ng-container matColumnDef="quantityOrder">
              <th mat-header-cell *matHeaderCellDef>Order</th>
              <td mat-cell *matCellDef="let element">
                {{ element.quantityOrder }}
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th
                mat-header-cell
                *matHeaderCellDef
                style="background-color: #004869; color: white"
              >
                Actions
              </th>
              <td mat-cell *matCellDef="let element">
                <mat-icon
                  matTooltip="Edit"
                  (click)="editWoQty(element)"
                  class="font icon-spacing icon"
                  style="color: #004869"
                  >edit</mat-icon
                >
                <mat-icon
                  matTooltip="Delete"
                  (click)="openConfirmDialog(element.workOrderQuantityid)"
                  class="font icon-spacing icon"
                  style="color: #d3493f"
                >
                  delete_forever</mat-icon
                >
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </ng-container>

        <ng-container
          *ngIf="hasAmendment1 && workOrderQuantitiesData.length > 0"
        >
          <table
            mat-table
            [dataSource]="workOrderQuantitiesData"
            class="mat-table"
            class="mat-elevation-z8"
          >
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef>#</th>
              <td mat-cell *matCellDef="let element; let i = index">
                {{ pageIndex * pageSize + i + 1 }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceCode">
              <th mat-header-cell *matHeaderCellDef>Service Code</th>
              <td mat-cell *matCellDef="let element">
                {{ element.serviceCode }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceDescription">
              <th mat-header-cell *matHeaderCellDef>Service Description</th>
              <td mat-cell *matCellDef="let element">
                <div [innerHTML]="element.serviceDescription"></div>
              </td>
            </ng-container>

            <ng-container matColumnDef="scUomRefValue">
              <th mat-header-cell *matHeaderCellDef>Service Uom</th>
              <td mat-cell *matCellDef="let element">
                {{ element.scUomRefValue }}
              </td>
            </ng-container>

            <ng-container matColumnDef="serviceGroupCode">
              <th mat-header-cell *matHeaderCellDef>Service Group</th>
              <td mat-cell *matCellDef="let element">
                {{ element.serviceGroupCode }}
              </td>
            </ng-container>

            <ng-container matColumnDef="primeActivityNumber">
              <th mat-header-cell *matHeaderCellDef>Prime Activity Number</th>
              <td mat-cell *matCellDef="let element">
                {{ element.primeActivityNumber }}
              </td>
            </ng-container>

            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef>Original Quantity</th>
              <td mat-cell *matCellDef="let element">
                {{ element.quantity | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="amendmentQuantity">
              <th mat-header-cell *matHeaderCellDef>Amendment Quantity</th>
              <td mat-cell *matCellDef="let element">
                {{ element.amendmentQuantity | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="totalQuantity">
              <th mat-header-cell *matHeaderCellDef>Total Quantity</th>
              <td mat-cell *matCellDef="let element">
                {{ element.totalQuantityAfterAmendment | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="rate">
              <th mat-header-cell *matHeaderCellDef>Rate</th>
              <td mat-cell *matCellDef="let element">
                {{ element.rate | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="value">
              <th mat-header-cell *matHeaderCellDef>Amount With Out Gst</th>
              <td mat-cell *matCellDef="let element">
                {{ element.totalAmountAfterAmedment | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="totalAmountWthGstAfterAmendment">
              <th mat-header-cell *matHeaderCellDef>Amount With Gst</th>
              <td mat-cell *matCellDef="let element">
                {{ element.totalAmountWthGstAfterAmendment | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="workOrderQuantityStatus">
              <th mat-header-cell *matHeaderCellDef>Quantity Status</th>
              <td mat-cell *matCellDef="let element">
                {{ element.workOrderQuantityStatus }}
              </td>
            </ng-container>
            <ng-container matColumnDef="quantityOrder">
              <th mat-header-cell *matHeaderCellDef>Order</th>
              <td mat-cell *matCellDef="let element">
                {{ element.quantityOrder }}
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th
                mat-header-cell
                *matHeaderCellDef
                style="background-color: #004869; color: white"
              >
                Actions
              </th>
              <td mat-cell *matCellDef="let element">
                <mat-icon
                  matTooltip="Edit"
                  (click)="editWoQty(element)"
                  class="font icon-spacing icon"
                  style="color: #004869"
                  >edit</mat-icon
                >
                <mat-icon
                  matTooltip="Delete"
                  (click)="openConfirmDialog(element.workOrderQuantityid)"
                  class="font icon-spacing icon"
                  style="color: #d3493f"
                >
                  delete_forever</mat-icon
                >
              </td>
            </ng-container>

            <tr
              mat-header-row
              *matHeaderRowDef="displayedColumnsAmendment"
            ></tr>
            <tr
              mat-row
              *matRowDef="let row; columns: displayedColumnsAmendment"
            ></tr>
          </table>
        </ng-container>
      </ng-container>
    </div>
  </mat-card-content>
  <b>
    <hr style="margin: 0" />
  </b>
  <mat-card-footer class="pagination-sec">
    <mat-paginator
      [length]="totalItems"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onPageChange($event)"
      showFirstLastButtons
      class="custom-paginator"
    ></mat-paginator>
  </mat-card-footer>
</mat-card>

<div class="add-mat-card-footer">
  <button
    mat-flat-button
    class="btn-class accent"
    (click)="gotoWo()"
    type="button"
  >
    BACK
  </button>
  <button
    mat-flat-button
    class="btn-class primary"
    type="submit"
    (click)="AddOrEditQuantity()"
  >
    BULK EDIT
  </button>
</div>
