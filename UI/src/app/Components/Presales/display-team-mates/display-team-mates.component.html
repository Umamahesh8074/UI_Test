<div class="head">MY TEAM</div>
<div class="example-button-row">
<mat-form-field appearance="fill" style="width: 30%;">
  <mat-label>Project</mat-label>
  <input
    type="text"
    matInput
    (input)="onProjectSerach($any($event).target?.value)"
    [formControl]="project"
    [matAutocomplete]="projectAuto"
  />
  <mat-autocomplete
    #projectAuto="matAutocomplete"
    (optionSelected)="onProjectSelect($event)"
    [displayWith]="displayProject"
  >
    <mat-option> All </mat-option>
    <mat-option *ngFor="let option of projects" [value]="option">
      {{ option.projectName }}
    </mat-option>
  </mat-autocomplete>
</mat-form-field>
<mat-form-field class="example-full-width" appearance="outline" style="width: 30%; padding-left: 10px;">
  <mat-label>Search/Select User</mat-label>
  <input
    type="text"
    matInput
    aria-label="Number"
    (input)="onUserSerach($any($event).target?.value)"
    [formControl]="userControl"
    [matAutocomplete]="auto1"
  />

  <mat-autocomplete
    #auto1="matAutocomplete"
    (optionSelected)="onUserSelete($event)"
    [displayWith]="displayUser"
  >
    <mat-option [value]=""> All </mat-option>
    <mat-option *ngFor="let user of userListByManagerId" [value]="user">
      {{ user.userName }}
    </mat-option>
  </mat-autocomplete>
</mat-form-field>
</div>
<mat-card>
  <table class="tree-table">
    <thead>
      <tr>
        <th class="row-heads">Team</th>
        <th class="row-heads">Project</th>
        <th class="row-heads">Team Name</th>
        <th class="row-heads">Head/Manager</th>
        <th class="row-heads">Member</th>
        <th class="row-heads">Phone Number</th>
        <th class="row-heads">Email</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let node of projectTeams; let i = index">
        <!-- Parent Node (Leads) -->
        <tr
          [ngClass]="{ 'main-row-active': isActive(getUniqueId(node, i)) }"
          style="cursor: cell"
        >
          <td (click)="toggle(getUniqueId(node, i))" style="display: flex">
            <mat-icon
              class="menu-icon"
              *ngIf="node.children && node.children.length > 0"
            >
              {{ isExpanded(getUniqueId(node, i)) ? "remove" : "add" }}
            </mat-icon>
            {{ node.name }}
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <!-- Child Nodes -->
        <ng-container *ngIf="node.children && isExpanded(getUniqueId(node, i))">
          <ng-container *ngFor="let child of node.children; let j = index">
            <tr
              [ngClass]="{
                'child-row-active': isActive(getUniqueId(child, i, j))
              }"
              style="cursor: cell"
            >
              <td></td>
              <td
                (click)="toggle(getUniqueId(child, i, j))"
                style="display: flex"
              >
                <mat-icon
                  class="menu-icon"
                  *ngIf="child.children && child.children.length > 0"
                >
                  {{ isExpanded(getUniqueId(child, i, j)) ? "remove" : "add" }}
                </mat-icon>
                {{ child.name }}
              </td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <!-- Sub-child Nodes -->
            <ng-container
              *ngIf="child.children && isExpanded(getUniqueId(child, i, j))"
            >
              <ng-container
                *ngFor="let subchild of child.children; let k = index"
              >
                <tr
                  [ngClass]="{
                    'sub-child-row-active': isActive(
                      getUniqueId(subchild, i, j, k)
                    )
                  }"
                >
                  <td></td>
                  <td></td>
                  <td
                    (click)="toggle(getUniqueId(subchild, i, j, k))"
                    style="display: flex"
                  >
                    <mat-icon
                      class="menu-icon"
                      *ngIf="subchild.children && subchild.children.length > 0"
                    >
                      {{
                        isExpanded(getUniqueId(subchild, i, j, k))
                          ? "remove"
                          : "add"
                      }}
                    </mat-icon>
                    {{ subchild.name }}
                  </td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                <!-- Further Sub-child Nodes (if any) -->
                <ng-container
                  *ngIf="
                    subchild.children &&
                    isExpanded(getUniqueId(subchild, i, j, k))
                  "
                >
                  <ng-container
                    *ngFor="
                      let furtherSubchild of subchild.children;
                      let l = index
                    "
                  >
                    <tr>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td
                        (click)="
                          toggle(getUniqueId(furtherSubchild, i, j, k, l))
                        "
                      >
                        {{ furtherSubchild.managerName }}
                      </td>
                      <td>{{ furtherSubchild.name }}</td>
                      <td>{{ furtherSubchild.phoneNumber }}</td>
                      <td>{{ furtherSubchild.email }}</td>
                    </tr>
                  </ng-container>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>
    </tbody>
  </table>
</mat-card>
