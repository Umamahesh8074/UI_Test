<h3 class="header">Security Report</h3>
<div class="example-button-row">
  <div>
    <mat-form-field
    appearance="outline"
    class="display-reports-search-class"
    style="margin-left: 30px"
  >
    <mat-label>Search/Select Project</mat-label>
    <input
      type="text"
      matInput
      [value]="selectedProject.projectName ? selectedProject.projectName : ''"
      (input)="searchProject($event)"
      [formControl]="projectFc"
      [matAutocomplete]="projectAuto"
    />
    <mat-autocomplete
      #projectAuto="matAutocomplete"
      (optionSelected)="onProjectSelect($event)"
      [displayWith]="displayProject"
    >
      <mat-option value="">All</mat-option>
      <mat-option *ngFor="let option of project" [value]="option">
        {{ option.projectName }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

    <mat-form-field appearance="outline" class="display-reports-search-class" style="margin-left: 30px;">
      <mat-label>Location Name</mat-label>
      <mat-select
        formControlName="qrgenertorId"
        (selectionChange)="onSelectLocation($event)"
      >
      <mat-option value="">All</mat-option>
        <mat-option
          *ngFor="let item of qrGenerator"
          [value]="item.location"
          [disabled]="isView"
        >
          {{ item.location }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="display-reports-search-class" style="margin-left: 30px;">
      <mat-label>User Name</mat-label>
      <mat-select
        formControlName="userId"
        (selectionChange)="onSelectUser($event)"
      >
      <mat-option value="">All</mat-option>
        <mat-option
          *ngFor="let item of securityReportData"
          [value]="item.userId"
          [disabled]="isView"
        >
          {{ item.userName }}
        </mat-option>
      </mat-select>
    </mat-form-field>


    <mat-form-field appearance="outline" class="display-reports-search-class" style="margin-left: 30px;">
      <mat-label>Status</mat-label>
      <mat-select formControlName="userId" (selectionChange)="onSelectStatus($event)">
        <mat-option value="">All</mat-option>
        <mat-option value="On Time" [disabled]="isView">On Time</mat-option>
        <mat-option value="Missed" [disabled]="isView">Missed</mat-option>


      </mat-select>
    </mat-form-field>




      <!-- Select Day Dropdown -->
      <mat-form-field appearance="outline" style="margin-left: 30px;">
        <mat-label>Select Day</mat-label>
        <mat-select
          [(value)]="selectedDay"
          (selectionChange)="handleDaySelection($event.value)"
        >
          <mat-option *ngFor="let day of days" [value]="day">
            {{ day.commonRefValue }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Date Range Picker -->
      <mat-form-field *ngIf="showDatePicker" class="time-picker" appearance="outline" [formGroup]="formData"  style="margin-left: 30px;">
        <mat-label>Select Date Range</mat-label>
          <mat-date-range-input [rangePicker]="picker" (click)="picker.open()">
            <input
              matStartDate
              placeholder="Start date"
              formControlName="startDate"
              (focus)="picker.open()"
            />
            <input
              matEndDate
              placeholder="End date"
              formControlName="endDate"
              (focus)="picker.open()"
            />
          </mat-date-range-input>
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>
      </mat-form-field>

      <button
      mat-raised-button
      color="primary"
      (click)="onClear()"
      class="mr-10 clr-button clear-top1 clr-btn-color"
      style="margin-left: 30px"
    >
      Clear
    </button>


        <button
          mat-flat-button
          class="btn-class download-button"
          (click)="downloadExcel()"
        >
          <mat-icon>download</mat-icon>
          download
        </button>


  </div>
  <div
    class="day-selector"
    [formGroup]="formData"
    style="text-align: center; display: inline-flex"
  ></div>
</div>

<mat-card class="cmn-card">
  <mat-card-content class="cmn-card-content">
    <div class="tab-head">
      <table
        matSort
        mat-table
        [dataSource]="securityReportData"
        class="mat-elevation-z8"
      >


      <ng-container matColumnDef="date">
        <th
          mat-header-cell
          *matHeaderCellDef
          style="background-color: #004869; color: white"
        >
          Date
        </th>
        <td mat-cell *matCellDef="let securityReport">
          {{ securityReport.createdDate ? (securityReport.createdDate | date: 'dd/MM/yyyy') : 'dd/mm/yyyy' }}
        </td>
      </ng-container>

        <ng-container matColumnDef="projectName">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="background-color: #004869; color: white"
          >
            Project Name
          </th>
          <td mat-cell *matCellDef="let securityReport">
            {{ securityReport.projectName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="location">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="background-color: #004869; color: white"
          >
            Location
          </th>
          <td mat-cell *matCellDef="let securityReport">
            {{ securityReport.location }}
          </td>
        </ng-container>

        <ng-container matColumnDef="userName">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="background-color: #004869; color: white"
          >
            User Name
          </th>
          <td mat-cell *matCellDef="let securityReport">
            {{ securityReport.userName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="scheduleTime">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="background-color: #004869; color: white"
          >
            Schedule Time
          </th>
          <td mat-cell *matCellDef="let securityReport">
            {{ securityReport.scheduleTime }}
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="background-color: #004869; color: white"
          >
            Status
          </th>
          <td mat-cell *matCellDef="let securityReport">
            {{ securityReport.status }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let securityReport; columns: displayedColumns"
        ></tr>
      </table>
    </div>
  </mat-card-content>
  <mat-card-footer>
    <mat-paginator
      [length]="totalItems"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onPageChange($event)"
      showFirstLastButtons
    ></mat-paginator>
  </mat-card-footer>
</mat-card>
