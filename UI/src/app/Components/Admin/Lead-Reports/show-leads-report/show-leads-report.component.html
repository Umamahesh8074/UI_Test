<div class="head">LEADS REPORT</div>
<mat-card>
  <table class="tree-table">
    <thead>
      <tr>
        <th class="row-heads">Leads</th>
        <th class="row-heads">Sources</th>
        <th class="row-heads">Sub-Sources</th>
        <th class="row-heads">Total</th>
        <th class="row-heads">Closed</th>
        <th class="row-heads">Lost</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let node of treeData; let i = index">
        <!-- Parent Node (Leads) -->
        <tr>
          <td (click)="toggle(getUniqueId(node, i))">
            <mat-icon
              class="menu-icon"
              *ngIf="node.children && node.children.length > 0"
            >
              {{ isExpanded(getUniqueId(node, i)) ? "remove" : "add" }}
            </mat-icon>
            {{ node.name }}
          </td>
          <td></td>
          <!-- Placeholder for Sources -->
          <td></td>
          <!-- Placeholder for Sub-Sources -->
          <td>{{ node.total ? node.total : "0" }}</td>
          <td>{{ node.closed ? node.closed : "0" }}</td>
          <td>{{ node.lost ? node.lost : "0" }}</td>
        </tr>
        <!-- Child Nodes (Sources) -->
        <ng-container *ngIf="node.children && isExpanded(getUniqueId(node, i))">
          <ng-container *ngFor="let child of node.children; let j = index">
            <tr>
              <td></td>
              <!-- Empty cell for Leads -->
              <td (click)="toggle(getUniqueId(child, i, j))">
                <mat-icon
                  class="menu-icon"
                  *ngIf="child.children && child.children.length > 0"
                >
                  {{ isExpanded(getUniqueId(child, i, j)) ? "remove" : "add" }}
                </mat-icon>
                {{ child.name }}
              </td>
              <td></td>
              <!-- Placeholder for Sub-Sources -->
              <td>{{ child.total ? child.total : "0" }}</td>
              <td>{{ child.closed ? child.closed : "0" }}</td>
              <td>{{ child.lost ? child.lost : "0" }}</td>
            </tr>
            <!-- Sub-child Nodes (Sub-Sources) -->
            <ng-container
              *ngIf="child.children && isExpanded(getUniqueId(child, i, j))"
            >
              <ng-container
                *ngFor="let subchild of child.children; let k = index"
              >
                <tr>
                  <td></td>
                  <!-- Empty cell for Leads -->
                  <td></td>
                  <!-- Empty cell for Sources -->
                  <td (click)="toggle(getUniqueId(subchild, i, j, k))">
                    {{ subchild.name }}
                  </td>
                  <td>{{ subchild.total ? subchild.total : "0" }}</td>
                  <td>{{ subchild.closed ? subchild.closed : "0" }}</td>
                  <td>{{ subchild.lost ? subchild.lost : "0" }}</td>
                </tr>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>
    </tbody>
  </table>
</mat-card>
